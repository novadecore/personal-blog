// schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model users {
  user_id       BigInt      @id @default(autoincrement())
  email         String      @unique
  password_hash String
  create_time   DateTime    @default(now())
  update_time   DateTime    @updatedAt

  // relations
  profile user_profiles?
  posts   posts[]
}

model user_profiles {
  user_id     BigInt     @id
  display_name String
  bio          String?   @db.Text
  role         String?   @db.TinyText
  avatar_url   String?
  create_time  DateTime  @default(now())
  update_time  DateTime    @updatedAt

  // relations
  user users @relation(fields: [user_id], references: [user_id], onDelete: Cascade)
}

model posts {
  post_id      BigInt      @id @default(autoincrement())
  user_id      BigInt
  title        String
  content      String       @db.Text
  image_mode   String?      // optional (varchar)
  status       String?      // e.g. "draft" / "published" / "archived"
  published_at DateTime?
  create_time  DateTime     @default(now())
  update_time  DateTime     @updatedAt

  // relations
  user   users       @relation(fields: [user_id], references: [user_id], onDelete: Cascade)
  images post_images[]
}

model post_images {
  image_id     BigInt     @id @default(autoincrement())
  post_id      BigInt
  image_url    String
  position     Int?
  create_time  DateTime   @default(now())
  update_time  DateTime   @updatedAt

  // relations
  post posts @relation(fields: [post_id], references: [post_id], onDelete: Cascade)
}
